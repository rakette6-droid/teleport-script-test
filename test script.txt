local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

local teleportDistance, spinning = 5, false
local directions = {{angle=0},{angle=45},{angle=90},{angle=135},{angle=180},{angle=-135},{angle=-90},{angle=-45}}

local function teleportAndLook(angle)
	local cf = hrp.CFrame
	local move = (cf * CFrame.Angles(0, math.rad(angle), 0)).LookVector * teleportDistance
	hrp.CFrame = CFrame.new(cf.Position + move) * CFrame.Angles(0, math.rad(angle), 0)
end

local function startSpin()
	if spinning then return end
	spinning = true
	task.spawn(function()
		while spinning do
			for _, d in ipairs(directions) do
				if not spinning then break end
				teleportAndLook(d.angle)
				task.wait(0.1)
			end
		end
	end)
end

local function stopSpin()
	spinning = false
end

UserInputService.InputBegan:Connect(function(i, p)
	if p then return end
	if i.KeyCode == Enum.KeyCode.Y then startSpin()
	elseif i.KeyCode == Enum.KeyCode.F then stopSpin() end
end)

local teleportDistance2, canTeleport, cooldown = 7, true, 0.2
local function teleport(key)
	if not canTeleport then return end
	local pos = hrp.Position
	if key == "W" then pos += hrp.CFrame.LookVector * teleportDistance2
	elseif key == "S" then pos -= hrp.CFrame.LookVector * teleportDistance2
	elseif key == "A" then pos -= hrp.CFrame.RightVector * teleportDistance2
	elseif key == "D" then pos += hrp.CFrame.RightVector * teleportDistance2 end
	hrp.CFrame = CFrame.new(pos, pos + hrp.CFrame.LookVector)
	canTeleport = false
	task.delay(cooldown, function() canTeleport = true end)
end

UserInputService.InputBegan:Connect(function(i, p)
	if p then return end
	local k = i.KeyCode
	if k == Enum.KeyCode.W then teleport("W")
	elseif k == Enum.KeyCode.S then teleport("S")
	elseif k == Enum.KeyCode.A then teleport("A")
	elseif k == Enum.KeyCode.D then teleport("D") end
end)

local teleportDistance3, running, forward = 7, false, true
local function flashTeleport()
	while running do
		local offset = forward and teleportDistance3 or -teleportDistance3
		local target = hrp.Position + hrp.CFrame.LookVector * offset
		hrp.CFrame = CFrame.new(target, target + hrp.CFrame.LookVector)
		forward = not forward
		task.wait(0.02)
	end
end

UserInputService.InputBegan:Connect(function(i, p)
	if p then return end
	if i.KeyCode == Enum.KeyCode.T and not running then
		running = true
		task.spawn(flashTeleport)
	elseif i.KeyCode == Enum.KeyCode.F and running then
		running = false
	end
end)

local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.ResetOnSpawn = false

local frame = Instance.new("Frame")
frame.Position = UDim2.new(1, -400, 1, -200)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BackgroundTransparency = 0.2
frame.BorderSizePixel = 0
frame.Parent = gui

local title = Instance.new("TextLabel")
title.BackgroundTransparency = 1
title.Font = Enum.Font.SourceSansBold
title.Text = "FE Teleport Script Attached!"
title.TextSize = 20
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = frame

local msg = Instance.new("TextLabel")
msg.BackgroundTransparency = 1
msg.Font = Enum.Font.SourceSans
msg.TextSize = 16
msg.TextWrapped = true
msg.TextColor3 = Color3.fromRGB(200, 200, 200)
msg.TextXAlignment = Enum.TextXAlignment.Left
msg.TextYAlignment = Enum.TextYAlignment.Top
msg.Text = "Press 'T' to start flash teleporting\nPress 'Y' to start spinning\nTo stop the flash/spin, press 'F'."
msg.Parent = frame

local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 60, 0, 25)
closeBtn.Position = UDim2.new(1, -70, 0, 10)
closeBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.Font = Enum.Font.SourceSansBold
closeBtn.TextSize = 14
closeBtn.Text = "Close"
closeBtn.Parent = frame

local padding = 20
local function resizeFrame()
	title.Size = UDim2.new(0, 360, 0, title.TextBounds.Y)
	title.Position = UDim2.new(0, padding/2, 0, padding/2)
	msg.Size = UDim2.new(0, 360, 0, msg.TextBounds.Y)
	msg.Position = UDim2.new(0, padding/2, 0, title.Size.Y + padding)
	frame.Size = UDim2.new(0, 360 + padding, 0, title.Size.Y + msg.Size.Y + padding * 2)
end

resizeFrame()

closeBtn.MouseButton1Click:Connect(function()
	local fadeTime = 0.7
	TweenService:Create(frame, TweenInfo.new(fadeTime), {BackgroundTransparency = 1}):Play()
	TweenService:Create(title, TweenInfo.new(fadeTime), {TextTransparency = 1}):Play()
	TweenService:Create(msg, TweenInfo.new(fadeTime), {TextTransparency = 1}):Play()
	TweenService:Create(closeBtn, TweenInfo.new(fadeTime), {TextTransparency = 1}):Play()
	task.wait(fadeTime + 0.2)
	gui:Destroy()
end)
